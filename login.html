<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Check</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <style>
        body { font-family: sans-serif; padding: 20px; text-align: center; }
        .google-btn { padding: 15px; background: #4285F4; color: white; border: none; border-radius: 5px; font-size: 16px; width: 100%; cursor: pointer; }
        /* এরর দেখানোর জন্য বক্স */
        #statusBox { 
            margin-top: 20px; 
            padding: 10px; 
            background: #f8d7da; 
            color: #721c24; 
            border: 1px solid #f5c6cb; 
            text-align: left; 
            font-size: 13px;
            display: none; /* প্রথমে লুকানো থাকবে */
        }
    </style>
</head>
<body>

    <h2>Login Testing Mode</h2>
    <p>নিচের বাটনে ক্লিক করুন। যদি কোনো সমস্যা হয়, নিচে লেখা আসবে।</p>

    <button class="google-btn" onclick="startLogin()">Google Login (Redirect)</button>

    <div id="statusBox">Loading...</div>

    <script>
        // আপনার কনফিগ
        const firebaseConfig = {
            apiKey: "AIzaSyDwGzTPmFg-gjoYtNWNJM47p22NfBugYFA",
            authDomain: "mock-test-1eea6.firebaseapp.com",
            projectId: "mock-test-1eea6",
            appId: "1:111849173136:web:8b211f58d854119e88a815"
        };

        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const statusBox = document.getElementById('statusBox');

        function log(msg) {
            statusBox.style.display = 'block';
            statusBox.innerHTML += msg + "<br><hr>";
        }

        // ১. পেজ লোড হওয়ার সাথে সাথে চেক করা হচ্ছে
        auth.onAuthStateChanged(user => {
            if (user) {
                log("✅ User Found: " + user.email);
                log("Redirecting to index.html...");
                setTimeout(() => window.location.replace("index.html"), 1000);
            } else {
                log("ℹ️ No User Logged in yet.");
            }
        });

        // ২. রিডাইরেক্ট থেকে ফিরে আসার পর কোনো এরর হয়েছে কি না দেখা
        auth.getRedirectResult()
            .then((result) => {
                if (result.credential) {
                    log("✅ Redirect Successful!");
                }
            })
            .catch((error) => {
                log("❌ ERROR: " + error.code);
                log("Message: " + error.message);
            });

        // ৩. লগইন ফাংশন
        function startLogin() {
            log("⏳ Starting Redirect...");
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithRedirect(provider);
        }
    </script>
</body>
</html>
